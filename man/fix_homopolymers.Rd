% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster.R
\name{fix_homopolymers}
\alias{fix_homopolymers}
\title{Attempt at "fixing" the consensus sequence in a homopolymer region}
\usage{
fix_homopolymers(cons_seq, ref_seq, min_homopoly_len = 6)
}
\arguments{
\item{cons_seq}{the consensus}

\item{ref_seq}{the reference sequence (there should be some confidence
that it is correct)}

\item{min_homopoly_len}{minimum homopolymer length to check and fix}
}
\value{
a data frame with these columns:
\itemize{
\item \emph{consensus}: the "fixed" consensus sequence
\item \emph{n_adjusted} the number of "fixed" homopolymer stretches
}
}
\description{
Attempt at "fixing" the consensus sequence in a homopolymer region
}
\details{
Resolves N-ambiguities in the consensus if surrounded by a homopolymer stretch,
replacing them with the corresponding reference sequence
(which is assumed to be the most likely true sequence)

Ns are usually found on the left side (or near it), as minimap2 tends to
left-align gaps, and if there is an ambiguous situation (base + gap), the
consensus becomes an N.
\enumerate{
\item A consensus/reference pairwise alignment is done
\item The leftmost N is identified
\item The first non-N base downstream (right) of this N is assumed to be
the repeated base (likely true if gaps are left-aligned).
Jump to 7. if none is found.
\item The longest stretch of the given base/N/gaps is searched in the aligned
consensus
\item If the aligned reference contains only the given base and gaps
within the range identified in 4., then the consensus sequence
is replaced with the aligned reference
\item Go back to 2., searching for the next N
\item Remove all gaps from the consensus and return this sequence
}
}
