% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster.R
\name{try_split_haplotypes}
\alias{try_split_haplotypes}
\title{Attempts splitting sequence cluster into two haplotypes.}
\usage{
try_split_haplotypes(
  reads,
  d,
  prefix,
  min_identical = 4,
  max_ratio = 3,
  fast = FALSE,
  cores = 1,
  ...,
  samtools = "samtools",
  minimap2 = "minimap2",
  verbose = FALSE
)
}
\arguments{
\item{reads}{XStringQuality object}

\item{d}{a data frame as returned by \link{dada2_denoise} and \code{ambig_consensus} with these columns:
\itemize{
\item id
\item top_uniques
\item consensus_ambigs
}}

\item{prefix}{Path prefix where the .bam alignment and .fasta reference is found
(may be overwritten!)}

\item{min_identical}{minimum number of \emph{identical} sequences supporting \emph{both}
of the dominant unique sequences}

\item{max_ratio}{maximum abundance ratio (mapped read abundances) for splitting}

\item{fast}{use faster compression (larger BAM file)}
}
\description{
Attempts splitting sequence cluster into two haplotypes.
}
\details{
Splitting is done if the sum of the consensus ambiguities of the two resulting
sequence variants is smaller than the number of consensus ambiguities of the parent
cluster.

Overwrites the existing BAM files and FASTA references in 'prefix'.
}
