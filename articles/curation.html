<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sequence curation • DadaNanoBC</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequence curation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DadaNanoBC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basecalling.html">Basecalling</a></li>
    <li><a class="dropdown-item" href="../articles/curation.html">Sequence curation</a></li>
    <li><a class="dropdown-item" href="../articles/lab.html">Lab methods</a></li>
    <li><a class="dropdown-item" href="../articles/primers.html">Primer design</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow steps</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../analysis-example.html">Example Report</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sequence curation</h1>
            
      

      <div class="d-none name"><code>curation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="report">Report<a class="anchor" aria-label="anchor" href="#report"></a>
</h2>
<p>The results of the automated analysis are saved in an Excel document
named <strong>report.xlsx</strong>. There is one row per barcode, the
columns are explained by comments in the document.</p>
<p>The <strong>issues</strong> list should be investigated more closely,
although not all of them are critical. The list can be filtered.</p>
<div class="float">
<img src="img/report-overview.png" alt="report overview"><div class="figcaption">report overview</div>
</div>
<div class="section level3">
<h3 id="final-sequence-set">Final sequence set<a class="anchor" aria-label="anchor" href="#final-sequence-set"></a>
</h3>
<p>The <em>seq1</em>, [<em>seq2</em>, etc.] columns in the
<strong>Curation</strong> section contain the final sequences. In case
of problems, they can be edited. Changed sequences appear in <span style="color:blue">blue</span></p>
<blockquote>
<p>FASTA sequences can be exported by a simple copy&amp;paste from the
<em>FA1</em> [<em>FA2</em>, etc.] columns to a text file (works well
with LibreOffice).</p>
</blockquote>
<blockquote>
<p><strong>Excel:</strong> copy&amp;paste to a <em>Word document</em>,
then copy&amp;paste to the final text file or search field, etc.
<em>OR</em>: copy directly to a text file, then remove all double quotes
(“) with search&amp;replace.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="common-problems">Common problems<a class="anchor" aria-label="anchor" href="#common-problems"></a>
</h2>
<div class="section level3">
<h3 id="inconsistent-taxonomy">Inconsistent taxonomy<a class="anchor" aria-label="anchor" href="#inconsistent-taxonomy"></a>
</h3>
<p>The <strong>tax-mimatch</strong> issue indicates a mismatch between
the taxonomic name in the <em>morpho-taxon</em> entry and the
sequence-based identification. Possible reasons:</p>
<ul>
<li>mis-identified specimen</li>
<li>something got mixed up when preparing
specimens/extracting/amplifying</li>
<li>the automatic taxonomy assignment of barcode sequences did not work
correctly, or the taxonomic lineages obtained from GBIF are not
correct</li>
<li>contamination not automatically recognized (<a href="analysis/workflow.html#taxonomic-assignments">how it works</a>)</li>
</ul>
<p>It is advisable to check the <em>details</em> worksheet: Copy the
sample barcode combination (e.g. <em>bc018-bc183</em>) and filter the
<em>details</em> table to list <em>all</em> sequences from this sample.
The <em>group</em> column indicates the taxon cluster (the top being the
one shown in the main table).</p>
<blockquote>
<p>If the top taxon group is not the correct one, copy from the
“sequence” field(s) to “seq1” (“seq2”, …) in the main table (paste
values).</p>
</blockquote>
<blockquote>
<p>The <strong>contamination</strong> issue indicates that contamination
is very likely present and was automatically down-ranked. It may also be
good to investigate these samples more precisely in the <em>details</em>
tab.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="ambiguities">Ambiguities<a class="anchor" aria-label="anchor" href="#ambiguities"></a>
</h3>
<p>If the alignment consensus has ambiguous positions
(<em>ambig-consensus</em> issue), these may be inspected by clicking on
<em>→ data</em> to open a folder with alignment files. Use a sequence
viewer of your choice, e.g. Geneious, CLC Workbench or UGENE.</p>
<p>The <em>…seq_comparison.fasta</em> file may be inspected first.
Inconsistencies should be readily visible (example alignment view in
Geneious).</p>
<p><img src="img/seq-comparison.png"></p>
<p>The BAM file (and the corresponding reference consensus sequences)
offer additional insights:</p>
<p><img src="img/aln-detail.png"></p>
<p>In this case, a long homopolymer stretch results in an unclear
sequence.</p>
<blockquote>
<p>Consider copying the “group1_seq1_dominant_seq” (= most abundant
sequence in sample) to the <em>seq1</em> column in the <em>Curation</em>
section (without gaps).</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="list-of-issues">List of issues<a class="anchor" aria-label="anchor" href="#list-of-issues"></a>
</h3>
<ul>
<li><p><strong>ambig-consensus:</strong> At least one of the top taxon
consensus sequences have ambiguities, suggesting either unresolved
sequence variation, or sequencing errors e.g. in long homopolmyer
regions. To investigate, click on “→ data” to open a folder with
alignment files. (see also <a href="https://github.com/markschl/DadaNanoBC/blob/main/templates/analysis/config.commented.yaml" class="external-link"><em>consensus_threshold</em>
setting</a>)</p></li>
<li><p><strong>tax-mismatch:</strong> Inconsistency found between the
name in the <em>morpho-taxon</em> column and the <em>auto-assigned
taxon</em> (see also “matching ranks” column). Strong inconsistencies
might indicate a preparation error or contamination, although
contamination is often automatically recognized.</p></li>
</ul>
<blockquote>
<p>Note that the automatic taxonomy is not always correct; it depends on
the reference database and the <a href="https://github.com/markschl/DadaNanoBC/blob/main/templates/analysis/config.commented.yaml" class="external-link">confidence
threshold</a></p>
</blockquote>
<ul>
<li><p><strong>contamination:</strong> The most abundant taxon is
suspected to be a contaminating sequence and was therefore ignored. This
happens if the prepared specimen was not “pure”, and DNA from the host
or another specie was co-amplified. The top taxon is still listed in the
“details” sheet, and manual inspection of at least part of the putative
contaminants is recommended to ensure that there are no errors in the
automatic ranking (see also <a href="https://github.com/markschl/DadaNanoBC/blob/main/templates/analysis/config.commented.yaml" class="external-link"><em>contam_rank_delta</em>
setting</a>)</p></li>
<li><p><strong>known-seq-diffs:</strong> There is at least one mismatch
between the top taxon and the provided “known” sequence. To investigate,
click on “→ data” to open a folder containing
…seq_comparison.fasta</p></li>
<li><p><strong>known-seq-contamination:</strong> The provided “known”
sequence appears to be a contamination itself</p></li>
<li><p><strong>many-variants:</strong> Strong sequence variability for
the top taxon (&gt;4 abundant variants above the frequency threshold).
Maybe multiple individuals are present in the DNA mix?</p></li>
<li><p><strong>low-coverage:</strong> Only few Nanopore sequences
support the top taxon. Low-coverage samples may have more ambiguities,
and there is a higher risk for errors (possibly investigate the BAM
alignments) (see also <a href="https://github.com/markschl/DadaNanoBC/blob/main/templates/analysis/config.commented.yaml" class="external-link"><em>low_abund_threshold</em>
setting</a>)</p></li>
<li><p><strong>&lt; 3 times overabundant</strong>: The top taxon is less
than 3x more abundant than the second taxon. It may be worth to check
for contamination.</p></li>
<li><p><strong>Related taxa in mix</strong>: The taxonomy assignment
suggests that there are several related taxa present in the same sample.
It may be worth to check for contamination to be sure that the top taxon
is actually the one you are looking for.</p></li>
<li><p><strong>Re-mapping to consensus gives another consensus</strong>:
During the clustering workflow, consensus sequences were not identical
before and after a re-mapping of reads. Consider inspecting the
alignments (see <em>ambig-consensus</em>).</p></li>
<li><p><strong>[consensus-diffs]:</strong> At least one of the top taxon
consensus sequences does not match the <em>dominant sequence</em>. This
is not necessarily an issue (as the consensus is always reported) but is
an indication for noisy data and/or low-depth samples.</p></li>
<li><p><strong>[homopolymer-fix]:</strong> At least one of the top taxon
consensus sequences contains one or several long homopolymer stretches
(≥ 6 bp), where the consensus was not unambiguous, since Nanopore has
difficulties in determining the correct repeat length. Instead of the
consensensus, the sequence was taken from the prevalent sequencing
read.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Schlegel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
