[{"path":"https://markschl.github.io/DadaNanoBC/articles/basecalling.html","id":"model","dir":"Articles","previous_headings":"","what":"Model","title":"Basecalling","text":"Different machine learning models available basecalling, offering different trade-offs speed accuracy. experience suggests sup model gives substantially better results hac model terms Q scores recognized primers/barcodes. Basecalling sup may take hours full day MinION run, depending GPU setup.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/basecalling.html","id":"on-your-computer","dir":"Articles","previous_headings":"","what":"On your computer","title":"Basecalling","text":"Dorado needed (dorado command available console). ’s installation size quite large (Gigabytes). basecalling done follows: easy way find actual paths Nanopore data drag & drop folders console, copy path .","code":"cd path/to/DadaNanoBC  # create the input directory (if not present) run_name=my_run mkdir -p analysis/$run_name  # Directory with the Nanopore data (may be on an external hard drive) ont_data=/media/user/run/data  # The basecalling model model=sup  # run the base-caller (may take a long time) # replace 'dorado' with full path to the 'dorado' binary if necessary dorado basecaller $model -r --no-trim --emit-fastq $ont_data | gzip -c > analysis/$run_name/reads.fastq.gz"},{"path":"https://markschl.github.io/DadaNanoBC/articles/basecalling.html","id":"on-a-hpc-server","dir":"Articles","previous_headings":"","what":"On a HPC server","title":"Basecalling","text":"Basecalling remote server slightly complicated. script shows SLURM server GPU node. remote_dir must contain job submission script (based template); can copied remote directory e.g. using FTP client; adjust dorado path email address inside script. message: “submitted batch job …”. Wait completion email execute:","code":"cd path/to/ont-barcoding  # run directory run_name=my_run run_dir=analysis/$run_name  # SSH login to HPC server ssh=user@server-address  # Remote directory containing the submission script (slurm_submit_basecaller.sh) # The base-called data is placed in $remote_dir/$run_name remote_dir=projects/ONT  # Nanopore data export directory ont_data=/media/user/run/data  # The basecalling model model=sup  # copy the data cd $run_dir rsync -av --info=progress2 \"$ont_data\" $ssh:$remote_dir/$run_name # submit the run ssh $ssh -t \"cd ~/$remote_dir && sbatch slurm_submit_basecaller.sh $model $run_name\" rsync -av $ssh/$remote_dir/$run_name/output.fastq.gz $analysis/$run_name/reads.fastq.gz"},{"path":"https://markschl.github.io/DadaNanoBC/articles/curation.html","id":"report","dir":"Articles","previous_headings":"","what":"Report","title":"Sequence curation","text":"results automated analysis saved Excel document named report.xlsx. one row per barcode, columns explained comments document. issues list investigated closely, although critical. list can filtered.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/curation.html","id":"final-sequence-set","dir":"Articles","previous_headings":"Report","what":"Final sequence set","title":"Sequence curation","text":"seq1, [seq2, etc.] columns Curation section contain final sequences. case problems, can edited. Changed sequences appear blue. Ambiguous sequences appear purple. FASTA sequences can exported simple copy&paste FA1 [FA2, etc.] columns text file (works well LibreOffice). Excel: copy&paste Word document, copy&paste final text file search field, etc. : copy directly text file, remove double quotes (“) search&replace.","code":""},{"path":[]},{"path":"https://markschl.github.io/DadaNanoBC/articles/curation.html","id":"inconsistent-taxonomy","dir":"Articles","previous_headings":"Common problems","what":"Inconsistent taxonomy","title":"Sequence curation","text":"tax-mismatch issue indicates mismatch taxonomic name morpho-taxon entry sequence-based identification. Possible reasons: mis-identified specimen something got mixed preparing specimens/extracting/amplifying automatic taxonomy assignment barcode sequences work correctly, taxonomic lineages obtained GBIF correct contamination automatically recognized advisable check details worksheet: Copy sample barcode combination (e.g. bc018-bc183) filter details table list sequences sample. group column indicates taxon cluster (top one shown main table). top taxon group correct one, copy “sequence” field(s) “seq1” (“seq2”, …) main table (paste values). contamination issue indicates contamination likely present automatically -ranked. may also good investigate samples precisely details tab.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/curation.html","id":"ambiguous-consensus","dir":"Articles","previous_headings":"Common problems","what":"Ambiguous consensus","title":"Sequence curation","text":"alignment consensus ambiguous positions (ambig-consensus issue), may inspected. alignemnts: separate setting active running pipeline, → data link open folder BAM alignment files. Use sequence viewer choice, e.g. Geneious, CLC Workbench UGENE. …seq_comparison.fasta file may inspected first. Inconsistencies readily visible (example alignment view Geneious).  BAM file (corresponding reference consensus sequences) offer additional insights:  necessary, copy correct sequence seq1 (seq2, etc.) column Curation section. become blue indicate something changed.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/curation.html","id":"complete-list-of-issues","dir":"Articles","previous_headings":"Common problems","what":"Complete list of issues","title":"Sequence curation","text":"issues critical, messages just provide context. ambig-consensus: least one top taxon consensus sequences ambiguities, suggesting either unresolved sequence variation, sequencing errors (consensus_threshold setting strongly influences whether issue appears, see infer_barcode()) tax-mismatch: Inconsistency found name morpho-taxon column auto-assigned taxon (see also “matching ranks” column). Strong inconsistencies might indicate preparation error contamination, although contamination often automatically recognized. Note automatic taxonomy always correct; depends reference database confidence_threshold setting (do_assign_compare_taxonomy()). contamination: abundant taxon suspected contaminating sequence therefore ignored. happens prepared specimen “pure”, DNA host another specie co-amplified. abundant taxon still listed “details” sheet, manual inspection least part putative contaminants recommended ensure errors automatic ranking (see also contam_rank_delta setting, do_assign_compare_taxonomy()) known-seq-diffs: least one mismatch top taxon provided “known” sequence. investigate, look “…_seq_comparison.bam”. known-seq-contamination: provided “known” sequence appears contamination many-variants: Strong sequence variability top taxon (>4 abundant variants frequency threshold). Maybe multiple individuals present DNA mix? low-coverage: Nanopore sequences support top taxon. Low-coverage samples may ambiguities, higher risk errors (possibly investigate BAM alignments) (see also low_abund_threshold, create_excel_report()) < 3 times overabundant: top taxon less 3x abundant second taxon. may worth check contamination. Related taxa mix: taxonomy assignment suggests several related taxa present sample. may worth check contamination sure top taxon actually one looking . Re-mapping consensus gives another consensus (rare): clustering workflow, consensus sequences identical re-mapping reads. Consider inspecting alignments. necessarily real issues: [consensus-diffs]: least one top taxon consensus sequences match dominant sequence. necessarily issue (consensus always reported) indication noisy data /low-depth samples. [homopolymer-fix]: least one top taxon consensus sequences contains one several long homopolymer stretches (≥ 6 bp), consensus unambiguous, since Nanopore difficulties determining correct repeat length. Instead consensensus, sequence taken prevalent sequencing read.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/lab.html","id":"primers","dir":"Articles","previous_headings":"","what":"Primers","title":"Lab methods","text":"forward reverse primers sample indexes mixed final concentration 5 µM (), diluted Qiagen elution buffer (10 mM Tris-HCl, pH 8.5).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/lab.html","id":"pcr-amplification","dir":"Articles","previous_headings":"","what":"PCR amplification","title":"Lab methods","text":"Using GoTaq G2 hot-start green master mix. First, distribute 7 µl well, add 2 µl forward + reverse primers 1 µl DNA separately. cycling protocol (36 PCR cycles): hepful check amplification gel least samples proceeding.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/lab.html","id":"pooling","dir":"Articles","previous_headings":"","what":"Pooling","title":"Lab methods","text":"Pooled 1.5 - 6 µl amplicon (depending sample number) 8-strip PCR tubes, combined Eppendorf tube. Cleanup AmpureXP beads (0.6:1 ratio works ; 300ul beads + 500ul pool) → eluted 30-40ul water elution buffer. Dilution 20 ng/ul = 1µg 50µl","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/lab.html","id":"library-preparation-and-sequencing","dir":"Articles","previous_headings":"","what":"Library preparation and sequencing","title":"Lab methods","text":"Following protocol Ligation sequencing V14 - PCR barcoding guide (newer), Starting step 6. End-prep Sequencing MinION 24h generate 20M reads: enough 15 plates, also obtained good barcode sequences samples 3M reads. 3 runs done flow cell","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"pipeline-steps","dir":"Articles","previous_headings":"","what":"Pipeline steps","title":"Workflow steps","text":"Search primers short sample indexes (located -/downstream primer sequences) group sample (de-multiplex); remove low-quality reads (do_trim_demux()) Infer barcode sequences using sequential procedure based DADA2 /fixed-threshold clustering (DECIPHER); compare already known sequences present (infer_barcode() / do_infer_all_barcodes()) Auto-assign taxonomy compare name given morphological identification (present) validate check contamination (do_assign_compare_taxonomy()) Export summary table, can manually curated (create_excel_report())","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"primer-search","dir":"Articles","previous_headings":"","what":"Primer search","title":"Workflow steps","text":"assumed sample-specific tags attached primers sides (dual indexing): TAG1FPRIMERBARCODESEQUENCERPRIMERTAG2 Combining multiple amplicons possible. Primers searched order amplicons appear sample sheet. Therefore, nested amplicons, shorter one placed end sheet.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"clustering","dir":"Articles","previous_headings":"","what":"Clustering","title":"Workflow steps","text":"basic procedure clustering implemented infer_barcode() function. procedure starts DADA2 clustering, followed consensus building. Additional steps may follow depending whether consensus unambiguous (alignment column supported enough identical bases), . workflow illustrated flowchart. Relevant configuration options shown grey.","code":""},{"path":[]},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"dada2-denoising","dir":"Articles","previous_headings":"Clustering > Steps/strategies","what":"DADA2 denoising","title":"Workflow steps","text":"DADA2 popular program inferring sequence variants (ASV) amplicon sequence data. program requires least error-free reads present. enough duplication, fixed-threshold clustering (see ) applied instead.  obtaining DADA2 ASV(s), next step infer consensus sequence ASV, usually identical ASV sequence. Ambiguous bases consensus sequence may indicate unresolved sequence variation, addressed attempting haplotype splitting sensitive denoising (see flowchart).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"haplotype-splitting","dir":"Articles","previous_headings":"Clustering > Steps/strategies","what":"Haplotype splitting","title":"Workflow steps","text":"DADA2 ASVs ambiguous consensus, checked two dominant sequences (supported identical sequences) serving references splitting sequencing reads two similarly abundant sub-clusters (ideally) unambiguous sequences. splitting done total number ambiguous bases two resulting consensus sequences smaller number ambiguous bases original consensus combined reads (see also non-public function try_split_haplotypes()). simple procedure often successful avoids re-run DADA2 higher sensitivity, may alo resolve InDel variation DADA2 discover.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"fixed-threshold-clustering","dir":"Articles","previous_headings":"Clustering > Steps/strategies","what":"Fixed-threshold clustering","title":"Workflow steps","text":"Fixed-threshold clustering applied low-coverage samples insufficient sequence duplication (see dada_min_identical dada_min_n0 settings infer_barcode(). default, single-linkage applied 97% identity threshold (DECIPHER). can result ambiguous consensus sequence, can still manually inspected.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"how-is-the-consensus-sequence-determined","dir":"Articles","previous_headings":"Clustering","what":"How is the consensus sequence determined?","title":"Workflow steps","text":"DADA2 denoising, haplotype splitting fixed-threshold clustering, raw (quality-filtered) reads aligned representative sequence (ASV dominant unique sequence) Minimap2. consensus sequence obtained samtools consensus using simple frequency-based approach. elaborate neural network-based inference (see e.g. Medaka) currently applied. default, base consensus sequence needs supported least 65% reads (weighted quality scores) unambiguous. Otherwise, ambiguous base shown, may indicate unresolved sequence variation. correctness consensus ensured re-mapping reads consensus sequence. necessary, step repeated samtools consensus returns sequence two successive rounds. final reported sequence always consensus sequence (see also vignette(\"curation\")). barcode sample sufficient read depth sequencing quality, usually unambiguous correct. low-depth samples ambiguities, alignments might inspected manually.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"homopolymers","dir":"Articles","previous_headings":"Clustering > How is the consensus sequence determined?","what":"Homopolymers","title":"Workflow steps","text":"length long homopolymer repeats often consistent different sequencing reads, can result N bases consensus. case, simple frequency-based approach used “fix” situation: homopolymer length taken abundant sequence (see fix_homopolymers()).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"taxa-grouping","dir":"Articles","previous_headings":"Clustering","what":"Taxa grouping","title":"Workflow steps","text":"Sequence variation within taxa (e.g. haplotypes) distinguished -taxa variation simple fixed-threshold single-linkage clustering done DECIPHER (default: 97% threshold). usually works well least barcode. problematic case closely related contaminant taxon DNA extract, may well distinghished target taxon.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/articles/workflow.html","id":"taxonomic-assignments","dir":"Articles","previous_headings":"","what":"Taxonomic assignments","title":"Workflow steps","text":"Taxonomic names automatically assigned SINTAX algorithm using reference database (see do_assign_compare_taxonomy()). Second, taxonomic names associated specimens compared sequence-based taxonomic assignments. , taxonomic overlap calculated, proportion matching ranks taxonomic lineages (far names defined levels). lineages retrieved GBIF backbone taxonomy. Inconsistent taxonomic labels may indicate errors preparation identification (possibly sequence-based identification), presence contamination. Potential dominant contaminants automatically flagged (see do_assign_compare_taxonomy(), details section).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Markus Schlegel. Author, maintainer.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Schlegel M (2026). DadaNanoBC: DADA2-Based Pipeline Infering DNA Barcodes Nanopore Sequence Data. R package version 0.1.0, https://github.com/markschl/DadaNanoBC.","code":"@Manual{,   title = {DadaNanoBC: DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data},   author = {Markus Schlegel},   year = {2026},   note = {R package version 0.1.0},   url = {https://github.com/markschl/DadaNanoBC}, }"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"dadananobc-nanopore-barcoding-pipeline","dir":"","previous_headings":"","what":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"R package provides functions clustering validating amplicon sequencing data specimen barcoding projects using Oxford Nanopore. Although tested, work PacBio data well. sample demultiplexing pooled reads inferring barcode sequences using DADA2-based clustering strategy accurately resolve haplotypes/polymorphic sequences automatic taxonomic assignents recognition (-ranking) contaminant taxa detailed output files (comprehensive Excel table curation, HTML report, BAM alignment files) See comprehensive explanation fully-fledged {targets} pipeline provided simple execution standard workflow (see ).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"what-type-of-data-does-it-work-with","dir":"","previous_headings":"","what":"What type of data does it work with?","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Basecalled amplicon reads sample-specific tags attached ends (dual-indexed) Reads sufficient quality (R10.4 chemistry) Amplicon lengths 0.5-1.5kb successfully tested Works fixed- variable-length amplicons different taxonomic groups can multiplexed analyzed separately different taxonomic database types can auto-downloaded (may implemented future)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"system-requirements","dir":"","previous_headings":"","what":"System requirements","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"UNIX environment (Linux, OS X Windows WSL2) Bash R installation Four command-line programs (see required software); package can always installed without , error messages appear calling functions rely missing components. basecalling Nanopore data yet done: Nvidia GPU Cuda support (details ).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"preparation-lab-work-and-basecalling","dir":"","previous_headings":"","what":"Preparation: lab work and basecalling","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Primer design (example report) PCR, library preparation sequencing Basecalling","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"installing-and-using-the-package","dir":"","previous_headings":"","what":"Installing and using the package","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"package documentation found . package provides mix lower higher level functions, core clustering function infer_barcode (detailed explanation ). high-level pipeline functions names starting do_ (e.g. do_trim_demux).","code":"devtools::install_github(\"markschl/DadaNanoBC\")"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"running-the-targets-pipeline","dir":"","previous_headings":"","what":"Running the {targets} pipeline","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"R console (running Bash, see ): files created, need still placed may also warnings missing software, handled (see required software). Next: Modify example metadata file meta-ITS5-ITS4.xlsx contain primer sequences sample metadata, rename meta.xlsx Copy move base-called sequencing reads reads.fastq.gz Adapt config.yaml needs; minimum, taxonony section needs contain correct taxonomic database. > Consider starting reduced read depth example configuration (max_sample_depth/max_contam_sample_depth) Run pipeline: Optional: Modify number parallel processes calling tar_make: Sys.setenv('DadaNanoBC_WORKERS' = 8)","code":"setwd(\"path/to/pipeline\") DadaNanoBC::init_pipeline() path/to/pipeline/  ├─ _targets.R               Pipeline R code  └─ analysis/     ├─ meta-ITS5-ITS4.xlsx   Metadata template (modify & rename to 'meta.xlsx')     ├─ config.yaml           Pipeline configuration (modify)     └─ reads.fastq.gz    <- Place base-called nanopore sequences here targets::tar_make()"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"output","dir":"","previous_headings":"Running the {targets} pipeline","what":"Output","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"files appear analysis directory: report.html (example report): detailed HTML report, useful troubleshooting report.xlsx: Excel report sequences taxonomic assignments, can inspected issues (see curation) separate_alignments (/top_alignments, alignments depending configuration): aligned sequencing reads BAM format, may imported sequence viewing/editing software Geneious/CLC Workbench/UGENE/IGV, etc. tmp: contains temporary (sometimes useful) data demultiplexed FASTQ sample files (sometimes separate_alignments many small BAM files, depending configuration); needed may delete files Inspect HTML report anomalies, maybe adjust settings re-run higher depth (adjust/remove max_sample_depth/max_contam_sample_depth)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"curation","dir":"","previous_headings":"Running the {targets} pipeline","what":"Curation","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Excel report contains sequences issue flags, might addressed exporting sequences. See curation tutorial","code":""},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"running-a-different-analysis","dir":"","previous_headings":"Running the {targets} pipeline","what":"Running a different analysis","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Prepare another directory appropriate meta.xlsx, reads.fastq.gz config.yaml. , set path run analysis. Taxonomic databases files taxdb directory reused.","code":"Sys.setenv('DadaNanoBC_ANALYSIS_DIR' = 'path/to/dir') targets::tar_make()"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"running-in-the-bash-console","dir":"","previous_headings":"","what":"Running in the bash console","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Install package already done Initialize directory pipeline run make sure files meta.xlsx, reads.fastq.gz config.yaml present analysis directory described . Run pipeline (default analysis directory, may changed): Additional settings can added afterwards, realistic example (see also custom program location):","code":"Rscript -e 'devtools::install_github(\"markschl/DadaNanoBC\")' cd path/to/pipeline Rscript -e 'DadaNanoBC::init_pipeline(bash = TRUE)' ./infer_barcodes analysis cd path/to/pipeline ./infer_barcodes analysis WORKERS=8 vsearch=path/to/vsearch"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"required-software","dir":"","previous_headings":"","what":"Required software","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"following tools required: seqtool primer trimming/demultiplexing samtools minimap2 dealing alignments VSEARCH sequence-based taxonomic assignments call init_pipeline() checks available software gives URLs missing software. following : message points download locations missing tools. Samtools, minimap2 VSEARCH available different sources: Debian/Ubuntu (including Windows WSL2 OSes): OS X Homebrew: Conda package manager (e.g. Conda-forge) (run bash console): Instructions downloading Seqtool given Github site.","code":"DadaNanoBC::check_system_requirements() sudo apt install -y samtools minimap2 vsearch brew install samtools minimap2 vsearch conda install -y -n DadaNanoBC -c bioconda samtools minimap2 vsearch conda activate DadaNanoBC ./infer_barcodes analysis_dir [options]"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"custom-program-location","dir":"","previous_headings":"Required software","what":"Custom program location","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"R needs know tool’s locations. placed standard location, either PATH environment variable needs adjustment, paths can communicated DadaNanoBC. R (example VSEARCH): Bash console, simply add program=... infer_barcodes call:","code":"DadaNanoBC::set_global_opts(vsearch = '~/Downloads/vsearch-2.30.2-linux-x86_64/bin/vsearch') tar_make() cd path/to/pipeline ./infer_barcodes analysis WORKERS=8 vsearch=~/Downloads/vsearch-2.30.2-linux-x86_64/bin/vsearch"},{"path":"https://markschl.github.io/DadaNanoBC/index.html","id":"useful-references","dir":"","previous_headings":"","what":"Useful references","title":"DADA2-Based Pipeline for Infering DNA Barcodes from Nanopore Sequence Data","text":"Srivathsan & Meier (2024) Hebert et al. (2024) barcoded 100k samples single MinION run. ONT barcoding efforts MycoMap network (see also methods description) (software used: NGSpeciesID)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/assign_taxonomy_sintax.html","id":null,"dir":"Reference","previous_headings":"","what":"Run taxonomy assignment (SINTAX algorithm) — assign_taxonomy_sintax","title":"Run taxonomy assignment (SINTAX algorithm) — assign_taxonomy_sintax","text":"requires VSEARCH installed.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/assign_taxonomy_sintax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run taxonomy assignment (SINTAX algorithm) — assign_taxonomy_sintax","text":"","code":"assign_taxonomy_sintax(   seq_file,   utax_db,   confidence_threshold = 0.8,   tmp_prefix = NULL,   threads = 1 )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/check_system_requirements.html","id":null,"dir":"Reference","previous_headings":"","what":"Check external software requirements and report missing programs — check_system_requirements","title":"Check external software requirements and report missing programs — check_system_requirements","text":"Check external software requirements report missing programs","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/check_system_requirements.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check external software requirements and report missing programs — check_system_requirements","text":"","code":"check_system_requirements()"},{"path":"https://markschl.github.io/DadaNanoBC/reference/compare_seqs.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare consensus/ASV and known sequences — compare_seqs","title":"Compare consensus/ASV and known sequences — compare_seqs","text":"Maps already known sequences inconsistent ASV sequences consensus creates small BAM alignment files containing just inconsistent consensus <-> cluster sequence comparisons consensus <-> known sequence comparisons (also useful manual inspection)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/compare_seqs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare consensus/ASV and known sequences — compare_seqs","text":"","code":"compare_seqs(d, bam_out = NULL, tmp_dir = NULL, known_seq = NULL)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/compare_seqs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare consensus/ASV and known sequences — compare_seqs","text":"data frame returned infer_barcode (needs consensus column).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/compare_seqs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare consensus/ASV and known sequences — compare_seqs","text":"Adds consensus_diffs column d (NA compared, Inf mapped due many mismatches) TODO: ambiguous bases unfortunately lead mismatches","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/create_excel_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an Excel report — create_excel_report","title":"Create an Excel report — create_excel_report","text":"Create Excel report","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/create_excel_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an Excel report — create_excel_report","text":"","code":"create_excel_report(   seq_tab,   outfile,   low_abund_threshold = 20,   min_seqs_unknown = 10,   n_curate = 4,   n_show_depth = 6,   bam_dir = NULL )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/create_excel_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an Excel report — create_excel_report","text":"seq_tab data frame returned do_assign_taxonomy outfile Excel output file low_abund_threshold add 'low-coverage' issues list samples less reads n_curate max. number sequences (polymorphism/haplotypes) top taxon list curation section n_show_depth max. number sequences (polymorphism/haplotypes) top taxon output read numbers bam_dir Path directory separate BAM files (→ data link appear). Relative hyperlinks generated bam_dir subdirectory dirname(outfile), otherwise absolute paths inserted, moving alignments directory break links. min_seqs ignore samples found reads (index combination) samples table less given number reads","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada2_denoise.html","id":null,"dir":"Reference","previous_headings":"","what":"Run DADA2 denoising — dada2_denoise","title":"Run DADA2 denoising — dada2_denoise","text":"Runs DADA2 FASTQ file, removes chimeras returns abundance-sorted data frame ASVs additional information","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada2_denoise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run DADA2 denoising — dada2_denoise","text":"","code":"dada2_denoise(   x,   dada_err,   cores = 1,   max_members = 1e+06,   singleton_threshold = 5,   ... )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada2_denoise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run DADA2 denoising — dada2_denoise","text":"x FASTQ file path derep-class object dada_err error information returned dada_learn_errors max_members random subsampling overly large ASVs specified number sequences singleton_threshold default, singletons form new cluster, low-depth samples (< N duplicates sequence), DETECT_SINGLETONS turned (see dada2::setDadaOpt). increases sensitivity InDel-rich Nanopore data prevents large proportion sequences discarded. ... Arguments passed dada2::dada","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada2_denoise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run DADA2 denoising — dada2_denoise","text":"data frame following columns: sequence top_uniques: abundance top unique sequences","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada_learn_errors.html","id":null,"dir":"Reference","previous_headings":"","what":"Learn error rates — dada_learn_errors","title":"Learn error rates — dada_learn_errors","text":"Calls dada2::learnErrors settings adjusted Nanopore data clustering procedure (infer_barcode)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/dada_learn_errors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Learn error rates — dada_learn_errors","text":"","code":"dada_learn_errors(fq_paths, omega_a = 1e-20, cores = 1, ...)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_combine_alignments.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine all BAM alignment files into a single one — do_combine_alignments","title":"Combine all BAM alignment files into a single one — do_combine_alignments","text":"Combine BAM alignment files single one","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_combine_alignments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine all BAM alignment files into a single one — do_combine_alignments","text":"","code":"do_combine_alignments(seq_tab, aln_dir, outdir, top_only = FALSE)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_combine_alignments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine all BAM alignment files into a single one — do_combine_alignments","text":"seq_tab Sequence table returned do_infer_all_barcodes downstream functions aln_dir Alignment directory (provided do_infer_all_barcodes) out_prefix Output prefix '.bam', '.bam.bai' '.fasta' files","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_combine_alignments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine all BAM alignment files into a single one — do_combine_alignments","text":"Named list output files","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_demux.html","id":null,"dir":"Reference","previous_headings":"","what":"Group sequences by sample index combination — do_demux","title":"Group sequences by sample index combination — do_demux","text":"Group sequences sample index combination","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_demux.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group sequences by sample index combination — do_demux","text":"","code":"do_demux(   primer_search_fq,   out_dir,   sample_tab,   error_threshold = 2.5,   min_barcode_length = 50 )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_demux.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group sequences by sample index combination — do_demux","text":"primer_search_fq One multiple paths do_primer_search (trimmed_fq entry returned list).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_demux.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group sequences by sample index combination — do_demux","text":"sample_tab reads_path column additional rows samples found reads sample table","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_demux.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Group sequences by sample index combination — do_demux","text":"See do_trim_demux details arguments read files out_dir named follows: fprimer-fidx--rprimer-ridx.fastq.gz Requires seqtool v0.4 higher","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_infer_all_barcodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer barcode sequences for all samples — do_infer_all_barcodes","title":"Infer barcode sequences for all samples — do_infer_all_barcodes","text":"High-level function calling infer_barcode compare_seqs every sample. Parallel processing possible cores > 1. Custom parallel processing frameworks can plugged providing parallel_lapply_fn.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_infer_all_barcodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer barcode sequences for all samples — do_infer_all_barcodes","text":"","code":"do_infer_all_barcodes(   seq_tab,   dada_err,   aln_out = NULL,   tmp_dir = NULL,   parallel_lapply_fn = NULL,   ...,   cores = 1 )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_infer_all_barcodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer barcode sequences for all samples — do_infer_all_barcodes","text":"seq_tab Sequence metadata table returned do_trim_demux do_demux dada_err Result dada_learn_errors aln_out Optional output directory BAM alignments (none saved NULL) tmp_dir Optional temporary directory (default: user-specific temporary directory, see set_global_opts)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_infer_all_barcodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer barcode sequences for all samples — do_infer_all_barcodes","text":"Input table (seq_tab) new column clustering, list data frames returned infer_barcode","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_primer_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Search and remove primer sequences — do_primer_search","title":"Search and remove primer sequences — do_primer_search","text":"Requires seqtool v0.4 higher See do_trim_demux details arguments","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_primer_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search and remove primer sequences — do_primer_search","text":"","code":"do_primer_search(   fq_paths,   amplicon_primers,   out_dir,   primer_max_err = 0.2,   idx_max_diffs = 0,   min_barcode_length = 50,   cores = 1 )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_primer_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search and remove primer sequences — do_primer_search","text":"Returns trimmed FASTQ paths (Zstandard-compressed) statistics: list(trimmed_fq = c(...), stats = list(...)). FASTQ files generated reads without primers/indexes reads short potential concatenated products.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_primer_search.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Search and remove primer sequences — do_primer_search","text":"function generates different FASTQ files out_dir, whereby trimmed.fastq.zst contains \"valid\" reads sample indexes sequence headers: <id> fi=<fwd-idx-name> ri=<rev-idx-name>","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_taxonomy.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","title":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","text":"function runs do_assign_taxonomy do_compare_taxonomy sequentially (functions documented).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_taxonomy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","text":"","code":"do_assign_compare_taxonomy(   seq_tab,   db_file,   gbif_cache_file,   tmp_dir = NULL,   confidence_threshold = 0.8,   summary_ranks = NULL,   known_contaminants = NULL,   likely_kingdom = NULL,   contam_rank_delta = 3,   cores = 1 )  do_assign_taxonomy(   seq_tab,   db_file,   tmp_dir = NULL,   confidence_threshold = 0.8,   summary_ranks = NULL,   cores = 1 )  do_compare_taxonomy(   seq_tab,   seq_lineages,   gbif_cache_file,   known_contaminants = NULL,   likely_kingdom = NULL,   contam_rank_delta = 3 )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_taxonomy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","text":"seq_tab Sequence table returned do_infer_all_barcodes downstream functions db_file Sequence database UTAX-formatted headers (optionally compressed); see load_taxdb gbif_cache_file Path cache file saving GBIF taxonomy lookup results (may shared across datasets) (see get_gbif_taxa) tmp_dir optional temporary directory saving intermediate sequence files confidence_threshold SINTAX bootstrap threshold (default: 0.8 / 80%) summary_ranks optional named character vector ranks show lineages (default: determine automatically) known_contaminants nested list specifying known contaminant names, list(family=c('Aspergillaceae', ...), genus=c(...)) likely_kingdom kingdom name providing guidance GBIF name search (see get_gbif_taxa) contam_rank_delta Require least N additional ranks matching provided (e.g. morphology-based) auto-assigned sequence-based taxonomic lineages taxon determined \"correct\" taxon mix, top taxon -ranked. setting affects \"sensitivity\" contaminant detection (lower: sensitive, also false classifications, higher: contamination may recognized). default 3 seems work well cases.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_taxonomy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","text":"do_assign_compare_taxonomy returns seq_tab, nested data frames clustering reordered dominant taxa flagged contamination moved bottom. following new columns added: unique_id: unique sequence id form: u1, u2, etc. taxon: auto-inferred taxon name (may correct, confirm BLAST identification methods) short_lineage: taxonomic lineage auto-inferred taxon (provided auto-inferred summary_ranks shown) is_contaminant: (logical) TRUE taxa recognized contamination matching_ranks: Number matching taxonomic ranks comparison provided auto-assigned sequence-based taxonomy (usually: kingdom/domain, phylum, class, order, family, genus, species). comparison can done highest defined rank either lineage. mismatching_ranks: Number non-matching ranks comparison provided auto-assigned sequence-based taxonomy unspecific: TRUE taxa top clusters table contamination ranking main seq_tab table contains columns data top sequence: top_seq_matching_ranks, top_seq_mismatching_ranks, top_seq_taxon, top_seq_short_lineage","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_taxonomy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run the taxonomy assignment and compare with provided taxonomic names of specimens — do_assign_compare_taxonomy","text":"Sequences flagged contamination (is_contaminant) : exists less abundant taxon correct kingdom (compared taxon, GBIF name comparison guided likely_kingdom) taxon least contam_rank_delta consistent (matching) taxonomic ranks GBIF lineage top taxon (explanation matching_ranks ); undefined ranks excluded comparison","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_trim_demux.html","id":null,"dir":"Reference","previous_headings":"","what":"Search and remove primers and sample indexes — do_trim_demux","title":"Search and remove primers and sample indexes — do_trim_demux","text":"do_trim_demux wrapper function running do_primer_search do_demux sequentially.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_trim_demux.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search and remove primers and sample indexes — do_trim_demux","text":"","code":"do_trim_demux(   fq_paths,   amplicon_primers,   sample_tab,   out_dir,   primer_max_err = 0.2,   idx_max_diffs = 0,   min_barcode_length = 50,   error_threshold = 2.5,   cores = 1,   keep_trimmed = FALSE )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_trim_demux.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search and remove primers and sample indexes — do_trim_demux","text":"fq_paths Character vector FASTQ file paths (compressed uncompressed) amplicon_primers Amplicon specification, returned parse_primer_tab sample_tab Sample table returned parse_sample_tab out_dir Output directory containing demultiplexed files (fprimer_fidx-rprimer_ridx.fastq.gz) primer_max_err Maximum allowed error rate primers (edit distance = substitutions/InDels). Default: 0.2 (20%) idx_max_diffs Maximum allowed differences forward/reverse sample index sequences; set high avoid tag switching (\"index hopping\") resulting \"background noise\" unspecific sequences. Default: 0 differences min_barcode_length Remove trimmed sequences shorter min_barcode_length; make sure value shorter expected minimal barcode length amplicons (default: 50 bp) error_threshold Maximum sequencing errors allowed per sequence (estimated quality scores). threshold impacts many sequences pass filter (see do_demux). Setting low may remove many sequences, setting high may lead noisy/errorneous results. default value 2.5 seems work well R10.4 data ~0.5-1.5 kb amplicons, removing half trimmed sequences.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_trim_demux.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search and remove primers and sample indexes — do_trim_demux","text":"list : seq_tab: sample_tab reads_path column additional rows samples found reads sample table trim_stats: list containing primer/index search statistics (used HTML report)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/do_trim_demux.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Search and remove primers and sample indexes — do_trim_demux","text":"Requires seqtool v0.4 higher installed either system-wide (PATH) locally (provide path set_program_path('seqtool', 'path//st')).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/fix_homopolymers.html","id":null,"dir":"Reference","previous_headings":"","what":"Attempt at ","title":"Attempt at ","text":"Attempt \"fixing\" consensus sequence homopolymer region","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/fix_homopolymers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attempt at ","text":"","code":"fix_homopolymers(cons_seq, ref_seq, min_homopoly_len = 6)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/fix_homopolymers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attempt at ","text":"cons_seq consensus ref_seq reference sequence (confidence correct) min_homopoly_len minimum homopolymer length check fix","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/fix_homopolymers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attempt at ","text":"data frame columns: consensus: \"fixed\" consensus sequence n_adjusted number \"fixed\" homopolymer stretches","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/fix_homopolymers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attempt at ","text":"Resolves N-ambiguities consensus surrounded homopolymer stretch, replacing corresponding reference sequence (assumed likely true sequence) Ns usually found left side (near ), minimap2 tends left-align gaps, ambiguous situation (base + gap), consensus becomes N. consensus/reference pairwise alignment done leftmost N identified first non-N base downstream (right) N assumed repeated base (likely true gaps left-aligned). Jump 7. none found. longest stretch given base/N/gaps searched aligned consensus aligned reference contains given base gaps within range identified 4., consensus sequence replaced aligned reference Go back 2., searching next N Remove gaps consensus return sequence","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/get_gbif_taxa.html","id":null,"dir":"Reference","previous_headings":"","what":"Match taxonomic names/lineages against the GBIF taxonomy — get_gbif_taxa","title":"Match taxonomic names/lineages against the GBIF taxonomy — get_gbif_taxa","text":"function uses GBIF web API (rgbif) retrieve currently accepted taxon name lineage according GBIF backbone taxonomy.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/get_gbif_taxa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match taxonomic names/lineages against the GBIF taxonomy — get_gbif_taxa","text":"","code":"get_gbif_taxa(   taxa,   cache_file,   known_kingdom = NA,   likely_kingdom = NA,   verbose = FALSE )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/get_gbif_taxa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match taxonomic names/lineages against the GBIF taxonomy — get_gbif_taxa","text":"taxa character vector taxonomic names matrix/data frame lineages; columns must rank names first column name, containing taxonomic names \"Russula sp.\" \"Bacteria\". lineages need complete (NA ranks allowed), presence may help matching.' cache_file Path past searches stored tab-separated text format. avoids havoing query GBIF API repeatedly thousands taxa. Delete file (individual lines) re-query GBIF API taxa. known_kingdom provide known kingdom alternative providing kingdom matrix lineages. Supplying kingdom may help resolve ambiguous matches. likely_kingdom kingdom known sure (likely), can provided . GBIF API searched without kingdom, result yielding complete lineage returned","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/get_gbif_taxa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match taxonomic names/lineages against the GBIF taxonomy — get_gbif_taxa","text":"matrix lineages; rows order taxa vector matrix","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/infer_barcode.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer barcode sequence(s) from raw reads in a single sample — infer_barcode","title":"Infer barcode sequence(s) from raw reads in a single sample — infer_barcode","text":"Applies clustering workflow provided raw reads, based DADA2 denoising /fixed-threshold clustering infer correct barcode sequence(s). groups resulting sequences putative taxon.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/infer_barcode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer barcode sequence(s) from raw reads in a single sample — infer_barcode","text":"","code":"infer_barcode(   fq,   dada_err,   alignment_prefix,   id_prefix = NULL,   tmp_dir = NULL,   dada_omega_a = c(1e-20, 1e-10, 0.01),   omegaA_iter_threshold = 1000,   dada_min_identical = 2,   dada_min_n0 = 4,   min_seq_abund = 3,   max_sample_depth = 5000,   consensus_max_depth = 3000,   consensus_threshold = 0.65,   consensus_by_qual = TRUE,   homopoly_fix_min_ident = 4,   min_homopoly_len = 6,   fixed_cluster_threshold = 0.97,   taxa_cluster_threshold = fixed_cluster_threshold,   cluster_single_linkage = TRUE,   min_variant_freq = 0.2,   split_min_identical = 4,   max_split_ratio = 3,   cores = 1,   verbose = FALSE )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/infer_barcode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer barcode sequence(s) from raw reads in a single sample — infer_barcode","text":"fq demultiplexed FASTQ file dada_err output dada_learn_errors alignment_prefix Optional output prefix BAM alignment files FASTA references manual inspection /downstream analyses id_prefix Name prefix sequence IDs consensus FASTA BAM alignment files tmp_dir Optional path temporary directory (details set_global_opts) dada_omega_a OMEGA_A parameter value(s) use denoising (see dada2::setDadaOpt): Can vector increasing values (default), tried sequentially grouping well-separated haplotypes non-ambiguous consensus sequence(s) found top taxon (note: others currently ignored) omegaA_iter_threshold evaluate multiple dada_omega_a values read depth larger given threshold. large samples, better avoid multiple denoising rounds, anyway likely DADA2 already find sequence variants first round (lowest OMEGA_A). Haplotype variation InDels may still found 'try_split_haplotypes', DADA2 denoising high sensitivity. dada_min_identical Minimum number identical sequences required DADA2 denoising. threshold, switch simple fixed-threshold clustering instead (fixed_cluster_threshold) report consensus without attempting haplotype splitting. dada_min_n0 Minimum number error-free reads needed retain DADA2 clustering (n0 dada-class $clustering information). Switch fixed-threshold clustering + consensus method threshold (see fixed_cluster_threshold). Note: error-free mean identical, DADA2 considers substitutions, can still InDels, n0 always equal higher number identical sequences. min_seq_abund minimum number supporting reads needed barcode sequence variant included results max_sample_depth read maximum max_sample_depth demultiplexed reads input file (fq) denoising/clustering consensus_max_depth maximum number sequences mapped clusters infer consensus sequence (, random sample taken) consensus_threshold require least given proportion bases identical every alignment column unambiguous consensus call (values default 60% might problematic) consensus_by_qual Consider read quality scores building consensus samtools consensus. TRUE, relative base frequencies weighted Phred quality scores. homopoly_fix_min_ident Minimum number identical sequences required attempt adjusting ambiguous homopolymer sequences consensus. homopolymer run length frequent sequence chosen. min_homopoly_len Minimum length homopolymer region needs order attempt \"fixing\" ambiguous consensus region (see also homopoly_fix_min_ident) fixed_cluster_threshold Similarity threshold grouping sequence variants per taxon. Single-linkage clustering applied, default threshold 0.97, maximum divergence two sequences can 3%. taxa_cluster_threshold Similarity threshold post-clustering DADA2 ASVs group potential haplotypes sequenced organism together. cluster_single_linkage Whether apply single-linkage fixed-threshold clustering low-depth samples. Clusters grow long two sequences least fixed_cluster_threshold similarity. FALSE, cluster members compared one centroid sequence remain concise (=complete-linkage clustering). (TRUE) default, appears work well low-coverage samples. min_variant_freq frequency threshold consider separate sequences (ASVs) taxon (clustered taxa_cluster_threshold) \"real\" polymorphisms (haplotypes), noise. split_min_identical min. number identical sequences needs support top two unique sequences sample order attempt haplotype splitting (sequences new references). max_split_ratio split ASV 2 parental haplotypes ratio larger:smaller max_split_ratio. haplotypes might always exact 1:1 ratio, constraint still enforces certain balancing haplotype abundances. unbalanced ratios possible DADA2 rerun higher sensitivity (see dada_omega_a).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/infer_barcode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer barcode sequence(s) from raw reads in a single sample — infer_barcode","text":"Returns data frame least following columns: id: Descriptive sequence ID, e.g.: 'taxon1_seq2' full_id: ID used BAM FASTA output files: id prefixed id_prefix taxon_num: Nth (putative) taxon (integer; see also taxa_cluster_threshold) sequence: DADA2 ASV abundant unique split sequence (NA case fixed-threshold clustering) consensus: consensus sequence haplotype member sequences consensus_ambigs: number ambiguous bases consensus (see consensus_threshold) consensus_diffs: edit distance consensus representative sequence (DADA2 ASV) dominant sequence (haplotype splitting/fixed-threshold clustering) homopolymer_adjustments: number homopolymer locations \"fixed\" inferring repeat number abundant sequence instead relying consensus (containing Ns) abundance: number reads clustering given sequence (max_sample_depth) n_mapped: number reads mapped barcode sequences (usually similar abundance) n0 DADA2: number error-free reads (substitutions, may still InDels) max_identical: max. number identical reads method: method haplotype emerged: one 'dada', 'dada_split' (haplotype splitting done), 'fixed_cluster' is_rare: TRUE relative frequency sequence within putative taxon min_variant_freq","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/init_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Scaffold the Targets Pipeline — init_pipeline","title":"Scaffold the Targets Pipeline — init_pipeline","text":"Copies _targets.R current directory (path) initializes analysis directory (without overwriting files).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/init_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scaffold the Targets Pipeline — init_pipeline","text":"","code":"init_pipeline(path = \".\", bash = FALSE, analysis_dir = \"analysis\")"},{"path":"https://markschl.github.io/DadaNanoBC/reference/init_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scaffold the Targets Pipeline — init_pipeline","text":"path create _targets.R files bash (logical) TRUE, initialize \"Bash mode\", means infer_barcodes Bash script copied along _targets.R analysis_dir Analysis directory","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/load_taxdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Download a taxonomic database and save it in UTAX format — load_taxdb","title":"Download a taxonomic database and save it in UTAX format — load_taxdb","text":"Download taxonomic database save UTAX format","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/load_taxdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download a taxonomic database and save it in UTAX format — load_taxdb","text":"","code":"load_taxdb(   db_url,   db_type = c(\"unite\", \"qiime_fasta\", \"qiime_qza\"),   db_file,   db_tax_url = NULL,   ... )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/load_taxdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download a taxonomic database and save it in UTAX format — load_taxdb","text":"db_url Character vector one file URLs; sequences URLs combined one final database. db_type Database type (character) (see details) db_file Output file (GZIPped FASTA, .fasta.gz) db_tax_url (optional) URL(s) pointing file(s) containing taxonomy sequences files db_url (currently implemented qiime_qza format)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/load_taxdb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download a taxonomic database and save it in UTAX format — load_taxdb","text":"Currently, three database types implemented (may follow): \"unite\": UNITE database (https://unite.ut.ee/repository.php): choose dataset (e.g. Eukaryotes), click file Downloads copy actual file URL file starts downloading browser. SH sequence set dynamic clustering threshold chosen archive imported. \"qiime_fasta\": FASTA file lineages headers form <seqid> rank1__name; rank2__name; ... whereby rank1 rank2 one-letter codes k (kingdom), g (genus), etc. sequences file, specify URL tab-delimited file mapping sequence IDs lineages. One example database providing files GTDB (e.g. ) \"qiime_qza\": QIIME2 QZA format, essentially ZIP file containing qiime_fasta-formatted FASTA file, another QZA file contain tab-delimited taxonomy (provide db_tax_url). function may expanded made flexible future","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_primer_tab.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a data frame with primer information — parse_primer_tab","title":"Parse a data frame with primer information — parse_primer_tab","text":"Parse data frame primer information","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_primer_tab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a data frame with primer information — parse_primer_tab","text":"","code":"parse_primer_tab(primer_tab, amplicons = NULL)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_primer_tab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a data frame with primer information — parse_primer_tab","text":"primer_tab Primer table (data frame-like; see details) amplicons Character vector amplicons pooled library; names form forward-reverse (primer names contain dashes)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_primer_tab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a data frame with primer information — parse_primer_tab","text":"named list amplicon metadata (named amplicons = forward-reverse). amplicon-specific item another list two entries (forward reverse), lists following entries: primer: named vector primer sequences index: named vector index sequences index_len: length index sequences (variable length currently allowed, lengths may vary forward reverse sample indexes)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_primer_tab.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parse a data frame with primer information — parse_primer_tab","text":"Columns primer_tab: primer-index: Primer name sample index name, delimited dash; primer names must contain dashes primer index correspond names amplicon column sample table (see parse_sample_tab). index_seq sample index sequence primer_seq primer sequence (repeated) amplicon provided, forward/reverse primers assumed order. amplicon may obtained amplicon column sample table (see parse_sample_tab).","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a data frame with sample metadata — parse_sample_tab","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"Parse data frame sample metadata","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"","code":"parse_sample_tab(sample_tab)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"sample_tab sample table (data frame-like, see details)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"valid sample metadata table (data frame) sample names de-duplicated (necessary)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"Required columns: Plate plate: A01-H12) amplicon: forward-reverse, name 'primer_index' column primer table; see parse_primer_tab indexes: forward-reverse, name 'primer_index' column primer table; see parse_primer_tab sample: sample name, duplicated sample_type: Sample type 'negative control', show reports; can left empty Optional columns: taxon: Known suspected taxon (rank), compared sequence-based identification used detecting contamination known sequence: Already known sequence (), e.g. previous Sanger sequencing; compared Nanopore-derived sequence","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/parse_sample_tab.html","id":"note-on-amplicon-multiplexing","dir":"Reference","previous_headings":"","what":"Note on amplicon multiplexing","title":"Parse a data frame with sample metadata — parse_sample_tab","text":"Primers searched order amplicons appear sample table nested amplicons, shorter one placed end. Also place amplicons little data amplicons similar primers make sure get \"swallowed\" case unspecific primer sample index matching.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/read_xlsx_primer_tab.html","id":null,"dir":"Reference","previous_headings":"","what":"Read primer information from Excel file — read_xlsx_primer_tab","title":"Read primer information from Excel file — read_xlsx_primer_tab","text":"Reads primer information Excel metadata file passes parse_primer_tab","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/read_xlsx_primer_tab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read primer information from Excel file — read_xlsx_primer_tab","text":"","code":"read_xlsx_primer_tab(meta_file, sheet_name, ...)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/read_xlsx_sample_tab.html","id":null,"dir":"Reference","previous_headings":"","what":"Read sample metadata from Excel file — read_xlsx_sample_tab","title":"Read sample metadata from Excel file — read_xlsx_sample_tab","text":"Reads sample table Excel metadata file passes parse_sample_tab","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/read_xlsx_sample_tab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read sample metadata from Excel file — read_xlsx_sample_tab","text":"","code":"read_xlsx_sample_tab(meta_file, sheet_name)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/set_global_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Set global options — set_global_opts","title":"Set global options — set_global_opts","text":"Convenience function setting global options program paths.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/set_global_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set global options — set_global_opts","text":"","code":"set_global_opts(...)"},{"path":"https://markschl.github.io/DadaNanoBC/reference/set_global_opts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set global options — set_global_opts","text":"following options can set: Required program paths (samtools, minimap2, seqtool, vsearch) tmp_dir: Path custom temporary directory short-lived data overly large data. Linux, default place files subdirectory $XDG_RUNTIME_DIR (usually /run/user/<userid>, tmpfs). hood, simply options(DadaNanoBC.opt = 'value', ...). options can set environment variables: DadaNanoBC_opt=value (R: Sys.setenv(DadaNanoBC_opt = 'value'). set_global_opt always priority environment variables.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/set_global_opts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set global options — set_global_opts","text":"","code":"set_global_opts(samtools = '/path/to/samtools', tmp_dir = '/tmp/nanopore-barcoding')"},{"path":"https://markschl.github.io/DadaNanoBC/reference/try_split_haplotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Attempts splitting sequence cluster into two haplotypes. — try_split_haplotypes","title":"Attempts splitting sequence cluster into two haplotypes. — try_split_haplotypes","text":"Attempts splitting sequence cluster two haplotypes.","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/try_split_haplotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attempts splitting sequence cluster into two haplotypes. — try_split_haplotypes","text":"","code":"try_split_haplotypes(   reads,   d,   prefix,   min_identical = 4,   max_ratio = 3,   fast = FALSE,   cores = 1,   ...,   samtools = \"samtools\",   minimap2 = \"minimap2\",   verbose = FALSE )"},{"path":"https://markschl.github.io/DadaNanoBC/reference/try_split_haplotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attempts splitting sequence cluster into two haplotypes. — try_split_haplotypes","text":"reads XStringQuality object d data frame returned dada2_denoise ambig_consensus columns: id top_uniques consensus_ambigs prefix Path prefix .bam alignment .fasta reference found (may overwritten!) min_identical minimum number identical sequences supporting dominant unique sequences max_ratio maximum abundance ratio (mapped read abundances) splitting fast use faster compression (larger BAM file)","code":""},{"path":"https://markschl.github.io/DadaNanoBC/reference/try_split_haplotypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attempts splitting sequence cluster into two haplotypes. — try_split_haplotypes","text":"Splitting done sum consensus ambiguities two resulting sequence variants smaller number consensus ambiguities parent cluster. Overwrites existing BAM files FASTA references 'prefix'.","code":""}]
